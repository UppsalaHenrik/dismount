getwd()
devtools::install_github("UppsalaHenrik/dismount")
?runParaRetries
library("dismount")
?runParaRetries
#' Get SLURM queue for active user
#'
#' Gets the slurm queue for the user that is currently logged in.
#' No options available. Returns a character string with the rows
#' of the queue, including the header.
#'
getUserSlurmQ <- function(){
# Get user name
userName <- system('echo "$USER"', intern=TRUE)
# Get the slurm queue for the active user
slurmQ <- system(paste("squeue", "-u", userName), intern=TRUE)
return(slurmQ)
}
?getUserSlurmQ
getwd()
library("roxygen")
library("roxygen2")
roxygenise()
?getUserSlurmQ
install("./../dismount/")
install.packages("./../dismount/")
detach("dismount")
detach("package:dismount", unload = TRUE)
install.packages("./../dismount/")
?dismount
??dismount
install.packages("./../dismount/")
??dismount
install.packages("./../dismount/")
devtools::install_github("UppsalaHenrik/dismount")
library("dismount")
?getUserSlurmQ
?setwd
roxygenise()
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/dismountWorkflow.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/waitForSlurmQ.R')
roxygenise()
?waitForSlurmQ
?runParaRetries
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/dismountWorkflow.R')
?read.csv
read.csv
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/dismountWorkflow.R')
saddleModelFiles
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/waitForSlurmQ.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/waitForSlurmQ.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/waitForSlurmQ.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/waitForSlurmQ.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/waitForSlurmQ.R')
roxygenise()
dir <- paste("dismount", modelFileNameNoExt, format(Sys.time(), "%y%m%d_%H%M%S"), sep = "_")
modelFileName
modelFileName <- "run83.mod"
modelFileNameNoExt <- sub("\\.[[:alnum:]]+$", "", basename(as.character(modelFileName)))
modelFileNameNoExt
modelFileName <- "./run83.mod"
modelFileNameNoExt <- sub("\\.[[:alnum:]]+$", "", basename(as.character(modelFileName)))
modelFileNameNoExt
dir <- paste("dismount", modelFileNameNoExt, format(Sys.time(), "%y%m%d_%H%M%S"), sep = "_")
dir
paste0("srun perl /blue/home/USER/yasao745/PsN4_4_ver_YA/isestimable ",
modelFileName, " -dir=", dir, " -run_on_slurm > ", dir, "/",
dir, "_log.txt 2>&1")
basename(as.character(modelFileName)
)
getwd()
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/dismountWorkflow.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/dismountWorkflow.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/dismountWorkflow.R')
source.with.encoding('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/dismountWorkflow.R', encoding='UTF-8')
setwd("C:/Users/hnyberg/Documents/GitHub/ddmore-use.cases/Reference/NONMEM/06262015_UseCases")
list.files(pattern = "fix.fit")
list.files(pattern = "fix.fit", recursive = TRUE)
fitVectorlist.files(pattern = "fix.fit", recursive = TRUE)
fitFiles <- list.files(pattern = "fix.fit", recursive = TRUE)
read.table(fitFiles[1], sep = "\s")
read.table(fitFiles[1], sep = " ")
read.table(fitFiles[1], sep = "\t")
read.table(fitFiles[1], sep = "\t")[1]
read.table(fitFiles[1], sep = "\t")[[1]]
read.csv(fitFiles[1], sep = "  ")
read.csv(fitFiles[1])
read.table(fitFiles[1])
read.table(fitFiles[1], skip = 1)
read.table(fitFiles[1], skip = 1, header = TRUE)
read.table(fitFiles[1], skip = 1, header = TRUE)["y"]
read.table(fitFiles[1], skip = 1, header = TRUE)["Y"]
x <- fitFiles[5]
x
strsplit(x, sep = "_")
strsplit(x, split = "_")
strsplit(x, split = "_")[1:2]
paste(strsplit(x, split = "_")[1:2], sep = "_")
strsplit(x, split = "_")[1:2]
strsplit(x, split = "_")[[1:2]]
strsplit(x, split = "_")[1][[1:2]]
strsplit(x, split = "_")[[1]]
strsplit(x, split = "_")[[1]][1:2]
paste(strsplit(x, split = "_")[[1]][1:2], sep = "_")
paste(c(strsplit(x, split = "_")[[1]][1:2]), sep = "_")
paste(strsplit(x, split = "_")[[1]][1], strsplit(x, split = "_")[[1]][2], sep = "_")
ucName <- paste(strsplit(x, split = "_")[[1]][1], strsplit(x, split = "_")[[1]][2], sep = "_")
ucName
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
yCol
names(yCol) <- ucName
yCol
head(yCol)
yColList <- sapply(fitFiles, function(x){
ucName <- paste(strsplit(x, split = "_")[[1]][1], strsplit(x, split = "_")[[1]][2], sep = "_")
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
names(yCol) <- ucName
}
)
yColList
yColList <- sapply(fitFiles, function(x){
ucName <- paste(strsplit(x, split = "_")[[1]][1], strsplit(x, split = "_")[[1]][2], sep = "_")
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
names(yCol) <- ucName
return(yCol)
})
yColList
cbind(yColList)
yColList <- sapply(fitFiles, function(x){
ucName <- paste(strsplit(x, split = "_")[[1]][1], strsplit(x, split = "_")[[1]][2], sep = "_")
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
names(yCol) <- ucName
return(yCol)
})
yColList
ucName
names(yCol)
cbind(unlist(yColList))
yColList
yColList[2]
ucNames <- paste(strsplit(fitFiles, split = "_")[[1]][1], strsplit(x, split = "_")[[1]][2], sep = "_")
ucNames
fitFiles
ucNames <- paste(strsplit(fitFiles, split = "_")[1], strsplit(x, split = "_")[2], sep = "_")
ucNames
fitFiles
fitFiles[[1]]
strsplit(fitFiles, split = "_")
fitFiles[[1]]
strsplit(fitFiles, split = "_")[1]
strsplit(fitFiles, split = "_")[[]][1]
strsplit(fitFiles, split = "_")[[1:30]][1]
strsplit(fitFiles, split = "_")[[1:29]][1]
strsplit(fitFiles, split = "_")[[1:29]]
strsplit(x, split = "_")
fitFiles
class(fitFiles)
gsub("_Holford.+" , x, )
x
gsub("_Holford.+" , "", x)
yColList <- sapply(fitFiles, function(x){
ucName <- gsub("_Holford.+" , "", x)
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
names(yCol) <- ucName
return(yCol)
})
yColList
ucNames <- gsub("_Holford.+" , "", fitFiles)
ucNames
cbind(unlist(yColList))
unlist(yColList)
class(yColList)
class(unlist(yColList))
list.files(pattern = "fix.fit", recursive = TRUE)
basename(list.files(pattern = "fix.fit", recursive = TRUE))
list.files(pattern = "fix.fit", recursive = TRUE)
fitFiles <- basename(list.files(pattern = "fix.fit", recursive = TRUE))
yColList <- sapply(fitFiles, function(x){
ucName <- gsub("_Holford.+" , "", x)
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
names(yCol) <- ucName
return(yCol)
})
x <- fitFiles[5]
ucName <- gsub("_Holford.+" , "", x)
ucName
ucName <- gsub("_.olford.+" , "", x)
ucName
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
fitFiles <-list.files(pattern = "fix.fit", recursive = TRUE)
ucName <- gsub("_.olford.+" , "",  basename(x)
)
x <- fitFiles[5]
ucName <- gsub("_.olford.+" , "",  basename(x))
ucName <- gsub("_.olford.+" , "",  basename(x))
x
ucName <- gsub("_.olford.+" , "",  basename(x))
ucName
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
yCol
names(yCol) <- ucName
yCol
yColList <- sapply(fitFiles, function(x){
ucName <- gsub("_.olford.+" , "",  basename(x))
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
names(yCol) <- ucName
return(yCol)
})
cbind(unlist(yColList))
fitFiles
head(yCol)
unlist(yColList)
do.call("cbind", yColList)
do.call("cbind", unlist(yColList))
yColList <- sapply(fitFiles, function(x){
ucName <- gsub("_.olford.+" , "",  basename(x))
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
#names(yCol) <- ucName
return(yCol)
})
yColList <- sapply(fitFiles, USE.NAMES = FALSE, function(x){
ucName <- gsub("_.olford.+" , "",  basename(x))
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
names(yCol) <- ucName
return(yCol)
})
yColList
do.call("cbind", yColList)
?cbind
?cbind.fill
cbind.fill <- function(...){
nm <- list(...)
nm <- lapply(nm, as.matrix)
n <- max(sapply(nm, nrow))
do.call(cbind, lapply(nm, function (x)
rbind(x, matrix(, n-nrow(x), ncol(x)))))
}
cbind.fill(yColList)
gsub("^........" , "",  basename(x))
grep("^........",  basename(x))
grep("^........",  basename(x), value = TRUE)
substring(x, 1, 8)
ucName <- substring(basename(x), 1, 8)
ucName
x
basename(x)
ucName <- substring(basename(x), 1, 8)
ucName
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
yCol
names(yCol) <- ucName
yCol
head(yCol)
yColList
do.call("cbind", yColList)
unlist(yColList)
do.call("cbind.fill", yColList)
data.frame(do.call("cbind.fill", yColList))
lala <- do.call("cbind.fill", yColList)
class(lala)
length(yColList)
do.call("rbind", yColList)
fitFiles
ucName <- substring(basename(x), 1, 8)
ucName
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
yCol
names(yCol) <- ucName
yCol
head(yCol)
class(yColList)
yColList <- sapply(fitFiles, USE.NAMES = FALSE, function(x){
ucName <- substring(basename(x), 1, 8)
yCol <- read.table(x, skip = 1, header = TRUE)["Y"]
names(yCol) <- ucName
return(yCol)
})
class(yColList)
length(yColList)
class(yColList[[1]])
do.call("cbind", yColList)
max(sapply(yColList, length))
numeric(2)
yColList <- sapply(fitFiles, USE.NAMES = FALSE, function(x){
ucName <- substring(basename(x), 1, 8)
yCol <- read.table(x, skip = 1, header = TRUE)[["Y"]]
yOut <- rep(NA_real_, times = 18805)
yOut[seq_along(yCol)] <- yCol
yCol <- data.frame(yOut)
colnames(yCol) <- ucName
return(yCol)
})
out <- do.call("cbind", yColList)
class(out)
dim(out)
head(out)
tail(out)
head(out)
write.csv(out, "UseCasesYCols.csv")
getwd()
getwd()
roxygenize()
library("roxygen2")
roxygenize()
list.files(pattern = paste0("retry.+\\.lst"))
list.files(pattern = paste0("retry.+\\.mod"))
dismountWD <- getwd()
setwd("C:\Users\hnyberg\Dropbox\Doktorandsaker\PrecondProject\dismount_example\para_retries_150811_110309")
setwd("C:\Users\hnyberg\Dropbox\Doktorandsaker\PrecondProject/dismount_example/para_retries_150811_110309")
setwd("C:\Users\hnyberg\Dropbox\Doktorandsaker\PrecondProject/dismount_example/para_retries_150811_110309")
setwd("C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/dismount_example/para_retries_150811_110309")
list.files(pattern = paste0("retry.+\\.mod"))
retryModFileNames <- list.files(pattern = paste0("retry.+\\.mod"))
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/runDismount.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/runDismount.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/runDismount.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
getwd()
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
subDirs = c()
subDirs
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
library(Hmisc)
x <- 1:5
inc(x) <- 5
x
inc
?inc
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
getwd()
subDirs <- c("lala", "lalala")
sapply(subDirs, dir.create)
subDirs = c()
sapply(subDirs, dir.create)
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
list.files(pattern = paste0(modFileNameNoExt, ".")
)
modFileNameNoExt <- "run83"
list.files(pattern = paste0(modFileNameNoExt, ".")
)
filePattern <- paste0(modFileNameNoExt, ".")
filesToCopy <- list.files(pattern = eval(filePattern))
filesToCopy
filePattern <- paste0(modFileNameNoExt, "\\.")
filesToCopy <- list.files(pattern = eval(filePattern))
filesToCopy
list.files(pattern = eval(filePattern))
filePattern <- paste0(modFileNameNoExt, ".")
filesToCopy <- list.files(pattern = eval(filePattern))
filesToCopy
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
filePattern <- paste0(modFileNameNoExt, "\\.")
filesToCopy <- list.files(pattern = eval(filePattern))
filesToCopy
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
getwd()
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
getwd()
setwd("../../dismount_example/para_retries_150811_110309/")
fileSysSetup("run83_retry10.mod", "lala", c("sub_lala1", "sub_lala2"))
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
fileSysSetup("run83_retry10.mod", "lala", c("sub_lala1", "sub_lala2"))
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/parseNMDataFileName.R')
fileSysSetup("run83_retry10.mod", "lala", c("sub_lala1", "sub_lala2"))
modFileNameNoExt <- fileSysSetup(modFileName, "massDismount", c("dismountRuns"))
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
modFileNameNoExt <- fileSysSetup("run83_retry10.mod", "massDismount", c("dismountRuns"))
rawresPath <- findRawres(paste0(paraRetriesDirName, "/."))
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/findRawres.R')
paraRetriesDirName
paraRetriesDirName <- "lalala"
rawresPath <- findRawres(paste0(paraRetriesDirName, "/."))
rawresPath <- findRawres(paste0(paraRetriesDirName, "\\."))
rawresPath <- findRawres(paste0(paraRetriesDirName, "\."))
rawresPath <- findRawres(paste0(paraRetriesDirName, "\"))
rawresPath <- findRawres(paste0(paraRetriesDirName, "\\"))
rawresPath <- findRawres(paste0(paraRetriesDirName, "\\"))
workflowDir <- getwd()
rawresPath <- findRawres(paraRetriesDirName)
getwd()
setwd("..")
getwd()
setwd("..")
getwd()
paraRetriesDirName
paraRetriesDirName <- "."
rawresPath <- findRawres(paraRetriesDirName)
rawresPath
rawres <- parseRawres(rawresPath)
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/parseRawres.R')
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/parseRawres.R')
rawres <- parseRawres(rawresPath)
rawresNoNA <- subset(rawres, ofv != 'NA')
retry <- rawresNoNA$model - 1
rawresNoNA <- cbind(retry, rawresNoNA)
minOfv <- min(rawresNoNA$ofv)
minOfv
retryModFileNames <- list.files(path = paraRetriesDirName, pattern = "retry.+.mod")
retryModFileNames
retryModFileNames <- list.files(path = paraRetriesDirName, pattern = "retry.+mod$")
retryModFileNames
paste0(retryModFileNames, "_lala")
paste0(paraRetriesDirName, "/", retryModFileNames)
getwd()
list.files()
copy.files(paste0(paraRetriesDirName, "/", retryModFileNames), "dismountRuns/")
file.copy(paste0(paraRetriesDirName, "/", retryModFileNames), "dismountRuns/")
file.copy(paste0(paraRetriesDirName, "/", retryModFileNames),
paste0("dismountRuns/", retryModFileNames))
file.copy(paste0(paraRetriesDirName, "/", retryModFileNames),
paste0("dismountRuns/", retryModFileNames))
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
subDirs
subDirs <- "dismountRuns"
filesToCopy
list.files()[1]
filesToCopy <- list.files()[1:2]
subDirs
sapply(subDirs, dir.create)
file.copy(filesToCopy, subDirs)
filesToCopy
filesToCopy <- list.files()[5:6]
filesToCopy
filesToCopy <- list.files()[24:25]
filesToCopy
file.copy(filesToCopy, subDirs)
subDirs
subDirs <- c("dismountRuns", "lala")
file.copy(filesToCopy, subDirs)
subDirs
sapply(subDirs, function(x){
dir.create(x)
file.copy(filesToCopy, x)
})
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/fileSysSetup.R')
file.copy(paste0(paraRetriesDirName, "/", retryModFileNames), dismountRunsDir)
dismountRunsDir
dismountRunsDir <- "dismountRuns"
file.copy(paste0(paraRetriesDirName, "/", retryModFileNames), dismountRunsDir)
file.copy(paste0(paraRetriesDirName, "/", retryModFileNames), dismountRunsDir)
file.copy(paste0(paraRetriesDirName, "/", retryModFileNames), dismountRunsDir)
setwd(dismountRunsDir)
getwd()
retryModFileNames
dismountDirList <- sapply(retryModFileNames, runDismount)
source('C:/Users/hnyberg/Dropbox/Doktorandsaker/PrecondProject/Scripts/dismount/R/runDismount.R')
dismountDirList <- sapply(retryModFileNames, runDismount)
